{% extends "base.html" %}
{% block body_contents %}
<link href="{{url_for('static', filename='styles/predictions.css')}}" rel="stylesheet">

<!--Section: Prediction -->
<section id="about" class="jumbotron text-center">

    <h2 class="mb-5 font-weight-bold">Predictions</h2>

    <div class="row d-flex justify-content-center mb-3">
        <div class="mb-3 col-md-6">
            <h6> <b class="font-weight-bold">Postcode:</b> {{postcode}}</h6>
            <h6> <b class="font-weight-bold">Brand:</b> {{brand}}</h6>
            <h6> <b class="font-weight-bold">Fuel Type:</b> {{fuel_type}}</h6>
        </div>
        <div class="mb-3 col-md-6">
            <h5 class="mb-3">Fuel is the cheapest on <span class="badge badge-pill green">{{cheapest_date}}</span>, <br><br>with its price being <span class="badge badge-pill green">¢ {{cheapest_price}}</span></h5>
        </div>
    </div>

    <!-- Nav Tabs -->
    <ul class="nav nav-tabs md-tabs nav-justified">
        <!-- Graph Nav -->
        <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#graph_content" role="tab">
                <h3 id="graph-nav"><i class="fa fa-line-chart" id="graph-icon"></i> Graph</h3>
            </a>
        </li>

        <!-- Table Nav -->
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#table_content" role="tab">
                <h3 id="table-nav"><i class="fa fa-table" id="table-icon"></i> Table</h3>
            </a>
        </li>
    </ul>
    
    <!-- Tab Panels -->
    <div class="tab-content card">
        <!-- Graph Panel -->
        <div class="tab-pane fade in show active" id="graph_content" role="tabpanel">
            <br>
            <canvas id="myChart" width="100" height="40"></canvas>
            <br>
        </div>

        <!-- Table Panel -->
        <div class="tab-pane fade" id="table_content" role="tabpanel">
            <table id="dtMaterialDesignExample" class="table table-striped" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th class="th-sm">Date
                            <i class="fa fa-sort float-right" aria-hidden="true"></i>
                        </th>
                        <th class="th-sm">Price (¢)
                            <i class="fa fa-sort float-right" aria-hidden="true"></i>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in predictions %}
                    <tr>
                        <td>{{row.date}}</td>
                        <td>{{row.predicted_price}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</section>
<script>
var ctx = document.getElementById("myChart").getContext('2d');
var date_dataset = {{date_dataset|safe}};
var price_dataset = {{price_dataset|safe}};
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: date_dataset,
        datasets: [{
            label: 'Price (¢)',
            backgroundColor: '#3E78C2',
			borderColor: '#071A29',
            data: price_dataset,
            fill: false,
            pointRadius: {{point_radius|safe}},
            pointBackgroundColor: {{point_colour|safe}},
        }]
    },
    options: {
        title: {
            display: true,
            text: 'Predicted prices of {{fuel_type|safe}} fuel at area {{postcode|safe}}'
        },
        tooltips: {
            mode: 'index',
            intersect: false,
        },
        hover: {
            mode: 'nearest',
            intersect: true
        },
    }
});
</script>
{% endblock %}